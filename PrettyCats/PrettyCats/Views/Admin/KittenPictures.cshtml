@model List<PrettyCats.DAL.Pictures>

@{
	ViewBag.Title = "Картинки котенка";
	Layout = "~/Views/Layouts/_AdminPanelLayout.cshtml";

	var backTo = "AdminChangeKittens";

	if (Model.Count > 0)
	{
		if (Model[0].Pets.First().IsParent)
		{
			backTo = "AdminChangeParents";
		}

		if (Model[0].Pets.First().IsInArchive)
		{
			backTo = "AdminChangeKittensArchive";
		}
	}
}

<script src="~/Scripts/jquery.unobtrusive-ajax.min.js" type="text/javascript"></script>

<script>
	function successRequest(itemId) {
		$('#' + itemId).hide();
	}

	function successChangeOrderRequest(itemId, newOrder) {
		$('input').find('#' + itemId).val(newOrder);
	}

	function ChangeOrder() {

		var mas = [];
		$('.kitten-block-admin').each(
			function (i, entry) {
				var id = $(entry).attr('id');
				var order = $(entry).find('#' + id).val();

				mas.push({ ID: id, Order: order });
		});

		//json += '}';
		json = JSON.stringify(mas, null, 2);
		//var json = $.toJSON(mas);

		$.ajax({
			url: '/Admin/ChangePicturesOrder',
			type: 'POST',
			datetype: 'json',
			data: json,
			contentType: 'application/json;',
			success: function () {
				$(':input').val('');
				location.reload();
			}
		});
	}
</script>

<h2>Фотографии котенка</h2>
<hr/>
<div style="margin-top: -20px;">
	@Html.ActionLink("Вернуться", backTo, "Admin", null, new { @class = "btn-admin btn-red" })
</div>
<div>
	<hr />
	@foreach (var i in Model.OrderBy(e=>e.Order))
	{
		@Html.Partial("_KittenPicture", i)
	}

</div>

<div class="form-group">
	<span>Изменить порядок сортировки</span>
	<input style="float:left; margin-left: 5px;" type="submit" onclick="ChangeOrder()" value="Изменить">
</div>


<div>
	@Html.ActionLink("Вернуться", backTo, "Admin", null, new { @class = "btn-admin btn-red" })
</div>