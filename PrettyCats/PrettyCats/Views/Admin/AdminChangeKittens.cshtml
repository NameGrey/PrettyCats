@using PrettyCats.Database
@model IEnumerable<Pets>

@{
	ViewBag.Title = "AdminDisplayAllKittens";
	Layout = "~/Views/Layouts/_AdminPanelLayout.cshtml";
}

<script src="@Url.Content("~/Scripts/DielogForm.js")"></script>
<link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/DialogForm.css")">

<style>
	#selectedFiles img {
		max-width: 125px;
		max-height: 125px;
		float: left;
		margin-bottom: 10px;
	}
</style>

<script>

	var files = [];

	function iterateFiles(filesArray, kittenName) {
		var count = 0;

		for (var i = 0; i < filesArray.length; i++) {
			for (var j = 0; j < filesArray[i].length; j++) {
				var request = new XMLHttpRequest();
				var formData = new FormData();
				
				formData.append('file', filesArray[i][j]);
				formData.append('kittenName', kittenName);

				request.open('post', '@Url.Action("AddImage", "Admin")');
				request.upload.onprogress = function(evt) {
					if (evt.lengthComputable) {
						var percentComplete = Math.ceil((evt.loaded / evt.total) * 100);

						if (percentComplete == 100) {
							++count;
						}
						$('#left-files').text(percentComplete + "% завершено");
					}
				};

				request.onreadystatechange = function () {
					if (request.readyState == 4) {
						if (request.status == 200) {
							$('#left-files').text(count + " файлов загрузилось!!!");
						}
					}
				}
				request.send(formData);
			}
		}
	}
</script>
<script src="~/Scripts/jquery.unobtrusive-ajax.min.js" type="text/javascript"></script>

<a href="AdminPanel" class="btn-admin btn-red">Назад</a>

@Html.ActionLink("Добавить", "AddKitten", null, new { id = "update-container", @class = "btn-admin btn-red" })


@foreach (var i in Model)
{
	@Html.Partial("KittenOnTheAdminPageHtml", i)
}
